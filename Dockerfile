FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGhlbGxvLXdvcmxkLWRiLWFwYgppbWFnZTogYW5zaWJsZXBsYXli\
b29rYnVuZGxlL2hlbGxvLXdvcmxkLWRiLWFwYgpkZXNjcmlwdGlvbjogQSBzYW1wbGUgQVBCIHdo\
aWNoIGRlcGxveXMgSGVsbG8gV29ybGQgRGF0YWJhc2UKYmluZGFibGU6IFRydWUKYXN5bmM6IG9w\
dGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBIZWxsbyBXb3JsZCBEYXRhYmFzZSAoQVBC\
KQogIGRlcGVuZGVuY2llczogWydkb2NrZXIuaW8vY2VudG9zL3Bvc3RncmVzcWwtOTQtY2VudG9z\
NyddCiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgogIC0gbmFt\
ZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IEEgc2FtcGxlIEFQQiB3aGljaCBkZXBsb3lzIEhl\
bGxvIFdvcmxkIERhdGFiYXNlCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlz\
cGxheU5hbWU6IERlZmF1bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95\
cyBhIFBvc3RncmVzIERhdGFiYXNlIHRoZSBIZWxsbyBXb3JsZCBhcHBsaWNhdGlvbiBjYW4gY29u\
bmVjdCB0bwogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBw\
b3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgRGF0YWJhc2UgTmFt\
ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgIC0gbmFt\
ZTogcG9zdGdyZXNxbF91c2VyCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgIC0gbmFtZTogcG9zdGdy\
ZXNxbF9wYXNzd29yZAogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFBhc3N3b3JkCiAgICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogYWRtaW4K"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
