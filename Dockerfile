FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wLjAKbmFtZTogaGVsbG8td29ybGQtZGItYXBiCmRlc2NyaXB0aW9uOiBBIHNh\
bXBsZSBBUEIgd2hpY2ggZGVwbG95cyBIZWxsbyBXb3JsZCBEYXRhYmFzZQpiaW5kYWJsZTogVHJ1\
ZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEhlbGxvIFdvcmxkIERh\
dGFiYXNlIChBUEIpCiAgZGVwZW5kZW5jaWVzOiBbJ2RvY2tlci5pby9jZW50b3MvcG9zdGdyZXNx\
bC05NC1jZW50b3M3J10KICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxh\
bnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogQSBzYW1wbGUgQVBCIHdoaWNo\
IGRlcGxveXMgSGVsbG8gV29ybGQgRGF0YWJhc2UKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRh\
OgogICAgICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMg\
cGxhbiBkZXBsb3lzIGEgUG9zdGdyZXMgRGF0YWJhc2UgdGhlIEhlbGxvIFdvcmxkIGFwcGxpY2F0\
aW9uIGNhbiBjb25uZWN0IHRvCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAg\
ICAtIG5hbWU6IHBvc3RncmVzcWxfZGF0YWJhc2UKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBE\
YXRhYmFzZSBOYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogYWRtaW4K\
ICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3VzZXIKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBV\
c2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAgLSBu\
YW1lOiBwb3N0Z3Jlc3FsX3Bhc3N3b3JkCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFzc3dv\
cmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkZWZhdWx0OiBhZG1pbgo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
